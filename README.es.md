[![Test](https://github.com/raul-macedo-freire/currency-challenge-bravo-api/actions/workflows/Tests.yml/badge.svg)](https://github.com/raul-macedo-freire/currency-challenge-bravo-api/actions/workflows/Tests.yml)

[![Python 3.10.6](https://img.shields.io/badge/python-3.10.6-blue.svg)](https://www.python.org/downloads/release/python-3106/)

<p align="center">
  <img src="https://gifs.eco.br/wp-content/uploads/2021/09/imagens-e-gifs-do-tio-patinhas-5.gif" alt="!LET'S MAKE SOME MONEY LAD/LASS!(read with scottish accent)"/>
</p>

# ü¶Ü üí≤**SCROOGE MCDUCK CURRENCY FLASK API- CURRENCY CHALLENGE BRAVO**üí≤ ü¶Ü

</br>

ScroogeMcDuckCurrencyApi es una aplicaci√≥n compatible con varias monedas que permite al usuario:

-   Convertir cantidades de una moneda a otras
-   Crea su propia moneda basada en el tipo de cambio del d√≥lar
-   Ejecute m√©todos RestFull b√°sicos, como: Buscar, actualizar y eliminar.

Esta API fue construida con[APLICACI√ìN Matraz](https://flask.palletsprojects.com/en/2.2.x/) and [Matraz-restx](https://flask-restx.readthedocs.io/en/latest/), por lo que se puede utilizar integrado con[Swagger.ui](https://swagger.io/tools/swagger-ui/)interfaz.

## üìñ**Documentos Idiomas disponibles:**

-   [ingl√©s](README.md)
-   [portugu√©s](README.pt.md)
-   [espa√±ol](README.es.md)

## üë∑**Servicio de terceros - OpenExchangeAPI**

</br>

Dado que las proporciones de divisas se actualizan constantemente, no es posible que un ser humano siga actualizando todos los datos de divisas para convertir cantidades din√°micamente. Por esa raz√≥n, ScroogeMcDuckCurrencyApi est√° integrado con[API de intercambio abierto](https://openexchangerates.org/)Servicio de moneda Api gratuito.</br> 
Howerver, once the user checks for a currency or whatever methods, ScroogeMcDuckCurrencyApi will not directly consult OpenExchange, but it's own database. Data that comes from OpenExchange is dynamically updated according to system scheduling configuration, to be explained in [configuraci√≥n](#api-configuration)secci√≥n.

## üíµ**Tasa de conversi√≥n del d√≥lar**

Scrooge McDuck Currency Api funciona en funci√≥n de la tasa de conversi√≥n del d√≥lar, por lo que cada moneda debe convertirse de su valor a d√≥lar, antes de convertirse a otra moneda.

Hagamos un ejemplo:

Si desea convertir la propia moneda de Scrooge McDuck en BRL (la moneda brasile√±a), debe tener la tasa de conversi√≥n de d√≥lares de la moneda de McDuck, o cu√°ntas monedas de McDuck necesita para convertirla en una mu√±eca.

Digamos que la tasa de conversi√≥n de d√≥lares de McDuck es 2 (lo cual no es posible ya que es demasiado rico), entonces necesitas 2 monedas de McDuck para hacer un d√≥lar. Hoy en d√≠a (y esto es impresionantemente aterrador), la tasa de conversi√≥n del d√≥lar de BRL a USD (identificador universal del d√≥lar) es de 5,22. Para convertir 5 McDuck's en Reales, hacemos:

(5/2)\*5,22 = 13,05 reales

<p align="center">
  <img src="https://images.gr-assets.com/hostedimages/1576518017ra/28622252.gif" alt="Math is fantastic!"/>
</p>

## üíâ**Inyecci√≥n de dependencia**

Para usar conceptos y herramientas de inyecci√≥n de dependencia, esta API usa python[Inyector](https://injector.readthedocs.io/en/latest/). Tuve que encontrar algunas l√≥gicas para que funcionara bien, lo que funcion√≥,~~En mi humilde opini√≥n~~~, muy bien y se ve bastante bien.

## ‚åö**programador**

ScroogeMcDuckCurrencyApi realiza operaciones cronol√≥gicas para actualizar la base de datos con OpenExchange api.</br>A pesar de que python tiene muchas bibliotecas para programar y poner en cola, como:[calendario](https://github.com/dbader/schedule),[cronista](https://github.com/kiorky/croniter)o[matraz-cronjob](https://pypi.org/project/flask-crontab/), este servicio no utiliza tales herramientas, con la intenci√≥n de buscar un enfoque m√°s eficiente.

## üìî**Almacenamiento de datos**

</br>

ScroogeMcDuckCurrencyApi tiene un[MongoDb](https://www.mongodb.com/en-us)base de datos para almacenar datos de OpenExchange e ingresados ‚Äã‚Äãpor los usuarios.</br>El uso de mongo facilita el uso de la fant√°stica[otro motor](https://docs.mongoengine.org/tutorial.html)paquete ORM de python, ya que proporciona una vista mucho mejor del c√≥digo con modelos de objetos.

## ‚ùó‚ùó**Descargo de responsabilidad**

</br>
ScroogeMcDuckCurrencyApi has a pretty nice interface and performs just fine given it's objective, however it does not perform automatic updates for  currencies that are not provided by OpenExchange API, in that way, in order to update custom currencies, the user must keep it up to date manually or create a provider to perform updates on the API from its source. 

</br>
</br>

El c√≥digo fuente de ScroogeMcDuckCurrencyApi tiene algunos comentarios que vale la pena buscar y que puede verificar buscando`NOTES:`

## ‚öôÔ∏è**Configuraci√≥n API**

</br>

A pesar de que esta aplicaci√≥n solo utiliza recursos gratuitos, la vida no siempre es un camino de rosas, tenemos algunos secretos que esconder üïµÔ∏è y algunas configuraciones que hacer.
De hecho, solo tenemos un secreto, que se explica a continuaci√≥n.</br>

#### <u>ID de aplicaci√≥n de OpenExchange</u>

</br>

OpenExchange proporciona una API de uso gratuito, pero, para usar esta API, debe tener una cuenta en Open Exchange. Para eso:

-   Ir[P√°gina de inicio de sesi√≥n de OpenExchange](https://openexchangerates.org/signup/free)
-   Crea tu cuenta
-   Verifique su ID de aplicaci√≥n en[P√°gina ID de la aplicaci√≥n](https://openexchangerates.org/account/app-ids)
-   Reemplazar el campo`{YOUR_OPENEXCHANGE_APP_ID_COMES_HERE}`a[archivo docker-compose](docker-compose.yml)

    **Obs:**Si tiene la intenci√≥n de ejecutar esta aplicaci√≥n usando un IDE, simplemente guarde su ID de aplicaci√≥n de Open Exchange como una variable de entorno con nombre`OPENEXCHANGE_APP_ID`.

#### <u>Programador de actualizaci√≥n de base de datos</u>

</br>

Por defecto, la API actualiza la base de datos con openExchange api cada 10 minutos, pero si desea aumentar o disminuir (¬øqui√©n sabe?) este retraso, simplemente reemplace el valor de`UPDATE_CURRENCIES_MINUTES_SCHEDULE`a[archivo docker-compose](docker-compose.yml)

**Obs:**Al igual que el[secci√≥n previa](#uopenexchange-app-idu), si est√° ejecutando la API localmente en su IDE, actualice la variable de entorno`UPDATE_CURRENCIES_MINUTES_SCHEDULE`.

## üèÉ**Ejecutando la aplicaci√≥n**

En primer lugar, clone el repositorio:

    git clone git@github.com:raul-macedo-freire/currency-challenge-bravo-api.git

Para ejecutar la API, tiene dos opciones:

-   Ejecutar con docker-compose
-   Ejecutar con un IDE

#### <b>Ejecutar con docker-compose</b>

Si no est√°s acostumbrado a trabajar con docker, echa un vistazo a la[documentos](https://docs.docker.com/get-started/overview/)e instalar[docker-compose](https://docs.docker.com/compose/).

Despu√©s de acostumbrarse a docker, configure el archivo docker-compose, de acuerdo con el[Secci√≥n de configuraci√≥n de API](#api-configuration)

En la carpeta del proyecto, ejecute:

```bash
docker compose up
```

Verifique la interfaz de la aplicaci√≥n en: https&#x3A;//localhost:5000/swagger

### <b>Ejecutar con un IDE</b>

Guarde las variables de entorno de acuerdo con el[Observaciones de configuraci√≥n de API](#api-configuration).

Si no est√° utilizando un administrador de dependencias, le recomiendo usar algo como[pytest](https://docs.pytest.org/en/latest/getting-started.html#install-pytest).

Si no desea usar pyenv e instalar dependencias en el entorno global de python (¬øqui√©n sabe?), salte a[Instalaci√≥n de dependencias](#uinstalling-dependenciesu)secci√≥n.

#### <u>Configurar el entorno de Python:</u>

Este proyecto usa python 3.10.6, considerar√© que est√° usando pyenv para la administraci√≥n de versiones de python, si no lo est√°, verifique la configuraci√≥n del administrador de dependencias y siga los pasos a continuaci√≥n de manera equivalente.

Compruebe la versi√≥n de Python:

```bash
python --version
```

Si no est√°s usando la versi√≥n 3.10.6, verifica si la tienes instalada, con:

```bash
pyenv versions
```

Si no lo hace, instale la versi√≥n con:

```bash
pyenv install -v 3.10.6
```

Luego configure la versi√≥n localmente:

```bash
pyenv local 3.10.6
```

En el directorio ra√≠z de la API, cree un nuevo entorno de python:

```bash
python -m venv <virtual-env-name>
```

Activar el entorno virtual

```bash
source <virtual-env-name>/bin/activate
```

si est√° usando Windows, acceda al entorno virtual con:

```bash
 .\venv\Scripts\activate
```

#### <u>Instalaci√≥n de dependencias:</u>

    pip install -r requirements.txt

### <u>Ejecutando la aplicaci√≥n:</u>

si est√°s usando[VSCODE](https://code.visualstudio.com/), ya he proporcionado un script de ejecuci√≥n con un[iniciar archivo](./.vscode/launch.json), as√≠ que si es el caso:

-   Guarde las variables de entorno en un`.env`expediente
-   Run the `run application`secuencia de comandos con el atajo F5.

Si no est√° utilizando VSCODE,~~empieza a usarlo~~, eche un vistazo a la configuraci√≥n de su IDE y ejecute la aplicaci√≥n desde el`run.py`archivo ra√≠z y no olvide guardar las variables de entorno en la configuraci√≥n.

Verifique la interfaz de la aplicaci√≥n en: https&#x3A;//localhost:5000/swagger

**!!!¬°¬°¬°NOTA!!!:**Si ejecuta la aplicaci√≥n de esta manera, no podr√° ejecutar solicitudes de API, ya que la base de datos no se ejecutar√°.

## üß™<b>Ejecuci√≥n de pruebas</b>

### <u>Pruebas unitarias</u>

Para ejecutar todas las pruebas unitarias, utilice:

```bash
python -m pytest
```

### <u>Pruebas de estr√©s</u>

Esta aplicaci√≥n utiliza la herramienta k6.io para realizar pruebas de estr√©s.
Comprobar el[documentaci√≥n k6](https://k6.io/docs/getting-started/installation/)para instalar la herramienta.

Para ejecutar la prueba, desde la ra√≠z de la aplicaci√≥n, ingrese a la carpeta de pruebas:

```bash
cd ./tests
```

Y ejecuta la prueba:

```bash
k6 run sovietic_attack.js 
```

**Obs1:**No olvide tener la aplicaci√≥n funcionando antes de ejecutar la prueba.

**Obs2:**Para realizar pruebas m√°s precisas para la API, cada punto final debe probarse individualmente, siguiendo las[consideraciones](https://k6.io/blog/how-to-generate-a-constant-request-rate-with-the-new-scenarios-api/), si quieres probar cada endpoint, descomenta el endpoint y comenta el resto (o no, nadie te manda`¬Ø\_(„ÉÑ)_/¬Ø`).

</br>

## üòé**Consideraciones finales**

Si eres muy malo con los ejemplos y no sabes c√≥mo empezar a probar la API, echa un vistazo a[cartero_ejemplos](postman_examples/ScroogeMcDuckCurrencyApi.postman_collection.json). Si no conoce al cartero, le recomiendo encarecidamente que[darle una oportunidad](https://www.postman.com/):D

# Documentaci√≥n resumida:

-   [penv](http://blog.abraseucodigo.com.br/instalando-qualquer-versao-do-python-no-linux-macosx-utilizando-pyenv.html)
-   [Pytest](https://docs.pytest.org/en/latest/getting-started.html#install-pytest)
-   [Matraz](https://flask.palletsprojects.com/en/2.2.x/)
-   [Matraz-Restx](https://flask-restx.readthedocs.io/en/latest/)
-   [El motor](https://docs.mongoengine.org/tutorial.html)
-   [API de intercambio abierto](https://openexchangerates.org/)
-   [Docker-Componer](docker-compose.yml)
-   [ksh](https://k6.io/docs/)

# 

## Estructura del proyecto

```
currency-challenge-bravo-api
‚îú‚îÄ .github
‚îÇ  ‚îî‚îÄ workflows
‚îÇ     ‚îú‚îÄ readme.yml
‚îÇ     ‚îî‚îÄ Tests.yml
‚îú‚îÄ .gitignore
‚îú‚îÄ .vscode
‚îÇ  ‚îú‚îÄ launch.json
‚îÇ  ‚îî‚îÄ settings.json
‚îú‚îÄ app
‚îÇ  ‚îú‚îÄ api.py
‚îÇ  ‚îú‚îÄ config
‚îÇ  ‚îÇ  ‚îú‚îÄ config.ini
‚îÇ  ‚îÇ  ‚îî‚îÄ config_helper.py
‚îÇ  ‚îú‚îÄ controllers
‚îÇ  ‚îÇ  ‚îú‚îÄ base_controller.py
‚îÇ  ‚îÇ  ‚îú‚îÄ currencies_controller.py
‚îÇ  ‚îÇ  ‚îú‚îÄ currency_controller.py
‚îÇ  ‚îÇ  ‚îú‚îÄ currency_converter_controller.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ core
‚îÇ  ‚îÇ  ‚îú‚îÄ entities
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ exceptions
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ base_exceptions.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ client_errors
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency_not_found.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ parameters_missing_error.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ validation_error.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ server_errors
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ configuration_error.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ external_service_error.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ infra_service_unauthorized.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ infra
‚îÇ  ‚îÇ  ‚îú‚îÄ models
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ repositories
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency_repository.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ interfaces
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ abstract_currency_repository.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ services
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ interfaces
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ abstract_external_currency_service.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ open_exchanges_api_service.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ ioc.py
‚îÇ  ‚îú‚îÄ middleware
‚îÇ  ‚îÇ  ‚îú‚îÄ exception_middleware.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ models
‚îÇ  ‚îÇ  ‚îú‚îÄ input_model
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ base_input_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency_converter_query_parameters_input_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ currency_input_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ update_currency_input_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ view_model
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ base_view_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ get_currencies_view_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ get_currency_view_model.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ scheduler.py
‚îÇ  ‚îú‚îÄ services
‚îÇ  ‚îÇ  ‚îú‚îÄ converter_service.py
‚îÇ  ‚îÇ  ‚îú‚îÄ currency_service.py
‚îÇ  ‚îÇ  ‚îú‚îÄ interfaces
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ abstract_converter_service.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ abstract_currency_service.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ update_db_worker.py
‚îÇ  ‚îî‚îÄ __init__.py
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ Dockerfile
‚îú‚îÄ LICENSE
‚îú‚îÄ mongo-init.js
‚îú‚îÄ README.es.md
‚îú‚îÄ README.md
‚îú‚îÄ README.pt.md
‚îú‚îÄ requirements.txt
‚îú‚îÄ run.py
‚îî‚îÄ tests
   ‚îú‚îÄ app
   ‚îÇ  ‚îú‚îÄ core
   ‚îÇ  ‚îÇ  ‚îú‚îÄ entities
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ test_currency.py
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îú‚îÄ infra
   ‚îÇ  ‚îÇ  ‚îú‚îÄ repositories
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ test_currency_repository.py
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îÇ  ‚îú‚îÄ services
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ test_open_exchanges_api_service.py
   ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îú‚îÄ services
   ‚îÇ  ‚îÇ  ‚îú‚îÄ test_converter_service.py
   ‚îÇ  ‚îÇ  ‚îú‚îÄ test_currency_service.py
   ‚îÇ  ‚îÇ  ‚îî‚îÄ __ini__.py
   ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îú‚îÄ sovietic_attack.js
   ‚îú‚îÄ tests_helper
   ‚îÇ  ‚îú‚îÄ factory
   ‚îÇ  ‚îÇ  ‚îú‚îÄ factory.py
   ‚îÇ  ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îÇ  ‚îú‚îÄ requests_mock.py
   ‚îÇ  ‚îî‚îÄ __init__.py
   ‚îî‚îÄ __init__.py

```
